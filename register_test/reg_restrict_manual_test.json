{
  "TestName": "reg_restrict_manual_test",
  "Users": [
    {
      "UserId": 1,
      "Number": "100",
      "Login": "100",
      "Password": "123",
      "SipDomain": "tau1.208.test.domain1",
      "Expires": 90,
      "SipGroup": "sip.ab",
      "Port": 12000,
      "QParam": 0.5,
      "OneTime": true
    },
    {
      "UserId": 2,
      "Number": "101",
      "Login": "101",
      "Password": "123",
      "SipDomain": "tau1.209.test.faka.domain2",
      "Expires": 90,
      "SipGroup": "sip.ab",
      "Port": 12001,
      "QParam": 0.5,
      "OneTime": true
    },
    {
      "UserId": 3,
      "Number": "101",
      "Login": "101",
      "Password": "123",
      "SipDomain": "tau1.210.mazafaka.test.domain3",
      "Expires": 90,
      "SipGroup": "sip.ab",
      "Port": 12002,
      "QParam": 0.5,
      "OneTime": true
    },
    {
      "UserId": 4,
      "Number": "800",
      "Login": "800",
      "Password": "dom1",
      "SipDomain": "domain1",
      "Expires": 90,
      "SipGroup": "sip.ab",
      "Port": 12004,
      "QParam": 0.5,
      "OneTime": true
    },
    {
      "UserId": 5,
      "Number": "800",
      "Login": "800",
      "Password": "dom2",
      "SipDomain": "domain2",
      "Expires": 90,
      "SipGroup": "sip.ab",
      "Port": 12005,
      "QParam": 0.5,
      "OneTime": true
    },
    {
      "UserId": 7,
      "Number": "800",
      "Login": "800",
      "Password": "dom3",
      "SipDomain": "domain3",
      "Expires": 90,
      "SipGroup": "sip.ab",
      "Port": 12007,
      "QParam": 0.5,
      "OneTime": true
    },
    {
      "UserId": 8,
      "Number": "801",
      "Login": "801",
      "Password": "dom1",
      "SipDomain": "domain1",
      "Expires": 90,
      "SipGroup": "sip.ab",
      "Port": 12008,
      "QParam": 0.5,
      "OneTime": true
    },
    {
      "UserId": 9,
      "Number": "801",
      "Login": "801",
      "Password": "dom2",
      "SipDomain": "domain2",
      "Expires": 90,
      "SipGroup": "sip.ab",
      "Port": 12009,
      "QParam": 0.5,
      "OneTime": true
    },
    {
      "UserId": 10,
      "Number": "801",
      "Login": "801",
      "Password": "dom3",
      "SipDomain": "domain3",
      "Expires": 90,
      "SipGroup": "sip.ab",
      "Port": 12010,
      "QParam": 0.5,
      "OneTime": true
    },
    {
      "UserId": 11,
      "Number": "100",
      "Login": "100",
      "Password": "123",
      "SipDomain": "msk.eltex.ru",
      "Expires": 90,
      "SipGroup": "sip.ab",
      "Port": 12011,
      "QParam": 0.5,
      "Mode": "Manual"
    },
    {
      "UserId": 12,
      "Number": "800",
      "Login": "800",
      "Password": "dom1",
      "SipDomain": "msk.eltex.ru",
      "Expires": 90,
      "SipGroup": "sip.ab",
      "Port": 12012,
      "QParam": 0.5,
      "Mode": "Manual"
    }
  ],
  "UserVar": [
    {}
  ],
  "PreConf": [
    "/domain/domain1/ss/enable %%12.Number%% cnip clip",
    "/domain/domain1/ss/activate %%12.Number%% cnip",
    "/domain/domain1/ss/activate %%12.Number%% clip"
  ],
  "PostConf": [
    "/domain/domain1/ss/deactivate %%12.Number%% cnip",
    "/domain/domain1/ss/deactivate %%12.Number%% clip",
    "/domain/domain1/ss/disable %%12.Number%% clip clip"
  ],
  "Tests": [
    {
      "Name": "\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0441\u0442\u0438 \u0434\u0435\u0442\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0412\u0410\u0422\u0421 (\u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u044b\u0435 \u043b\u043e\u0433\u0438\u043d\u044b)",
      "Description": "\u0412 \u0440\u0430\u0437\u043d\u044b\u0445 \u0434\u043e\u043c\u0435\u043d\u0430\u0445 \u0435\u0441\u0442\u044c \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u044b\u0435 \u044e\u0437\u0435\u0440\u044b \u0441 \u0440\u0430\u0437\u043d\u044b\u043c\u0438 \u043f\u0430\u0440\u043e\u043b\u044f\u043c\u0438. \u0412 \u0434\u0430\u043d\u043d\u043e\u043c \u0442\u0435\u0441\u0442\u0435 \u0434\u0435\u043b\u0430\u0435\u0442\u0441\u044f \u043f\u043e\u043f\u044b\u0442\u043a\u0430 \u0432\u044b\u0437\u043e\u0432\u0430 \u044e\u0437\u0435\u0440\u0430 \u0441 \u043e\u0434\u043d\u043e\u0433\u043e \u0434\u043e\u043c\u0435\u043d\u0430 \u0432 \u0434\u0440\u0443\u0433\u043e\u043c \u0434\u043e\u043c\u0435\u043d\u0435.",
      "TestProcedure": [
        {
          "StartUA": [
            {
              "Type": "User",
              "UserId": 4,
              "Name": "UAC1_TEST_CALL",
              "Commands": [
                {
                  "SourceFile": "register_test/uac_recv_403.xml",
                  "Options": "-m 1 -set CDPN %%2.Number%% -set CDPNDOM domain2",
                  "SippType": "uac",
                  "NeedAuth": true,
                  "Timeout": "20s"
                }
              ]
            },
            {
              "Type": "User",
              "UserId": 5,
              "Name": "UAC2_TEST_CALL",
              "Commands": [
                {
                  "SourceFile": "register_test/uac_recv_403.xml",
                  "Options": "-m 1 -set CDPN %%3.Number%% -set CDPNDOM domain3",
                  "SippType": "uac",
                  "NeedAuth": true,
                  "Timeout": "20s"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "Name": "\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0441\u0442\u0438 \u0434\u0435\u0442\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0412\u0410\u0422\u0421 (\u043c\u0430\u0442\u0447\u0438\u043d\u0433 \u0412\u0410\u0422\u0421)",
      "Description": "\u041f\u043e\u043f\u044b\u0442\u043a\u0430 \u043f\u043e\u0437\u0432\u043e\u043d\u0438\u0442\u044c \u043d\u0430 \u044e\u0437\u0435\u0440\u0430 \u0441 \u0441\u043e\u0441\u0442\u043e\u0432\u043d\u044b\u043c CDPNDOMAIN",
      "TestProcedure": [
        {
          "StartUA": [
            {
              "Type": "User",
              "UserId": 4,
              "Name": "UAC1_TEST_CALL",
              "Commands": [
                {
                  "SourceFile": "simple_ua/uac_recv_bye.xml",
                  "Options": "-m 1 -set CDPN %%8.Number%% -set CDPNDOM eltex.faka.%%8.SipDomain%%",
                  "SippType": "uac",
                  "NeedAuth": true,
                  "Timeout": "20s"
                }
              ]
            },
            {
              "Type": "User",
              "UserId": 8,
              "Name": "UAS2_TEST_CALL",
              "Commands": [
                {
                  "SourceFile": "simple_ua/uas_send_bye.xml",
                  "Options": "-m 1 -d 2000",
                  "SippType": "uas",
                  "NeedAuth": true,
                  "Timeout": "20s"
                }
              ]
            }
          ]
        },
        {
          "StartUA": [
            {
              "Type": "User",
              "UserId": 4,
              "Name": "UAC1_TEST_CALL",
              "Commands": [
                {
                  "SourceFile": "simple_ua/uac_recv_bye.xml",
                  "Options": "-m 1 -set CDPN %%1.Number%% -set CDPNDOM %%1.SipDomain%%",
                  "SippType": "uac",
                  "NeedAuth": true,
                  "Timeout": "20s"
                }
              ]
            },
            {
              "Type": "User",
              "UserId": 1,
              "Name": "UAS2_TEST_CALL",
              "Commands": [
                {
                  "SourceFile": "simple_ua/uas_send_bye.xml",
                  "Options": "-m 1 -d 2000",
                  "SippType": "uas",
                  "NeedAuth": true,
                  "Timeout": "20s"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "Name": "\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043e\u0442\u0431\u043e\u044f \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u0434\u0435\u0442\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 PBX (\u043f\u0435\u0440\u0435\u0441\u0435\u0447\u0435\u043d\u0438\u0435 pn)",
      "Description": "\u0417\u0430\u0434\u0430\u0451\u043c \u043e\u0434\u0438\u043d \u0438 \u0442\u043e\u0442 \u0436\u0435 public_name \u0434\u043b\u044f \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0434\u043e\u043c\u0435\u043d\u043e\u0432 \u0438 \u043f\u044b\u0442\u0430\u0435\u043c\u0441\u044f \u043f\u043e\u0437\u0432\u043e\u043d\u0438\u0442\u044c \u0441 \u0434\u0430\u043d\u043d\u044b\u0445 public_name. \u0412\u044b\u0437\u043e\u0432 \u043f\u0440\u043e\u0439\u0442\u0438 \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d",
      "TestProcedure": [
        {
          "StartUA": [
            {
              "Type": "User",
              "UserId": 4,
              "Name": "UAC1_TEST_CALL",
              "Commands": [
                {
                  "SourceFile": "register_test/uac_recv_403.xml",
                  "Options": "-m 1 -set CDPN %%8.Number%% -set CDPNDOM %%8.SipDomain%%.duplicate.pn",
                  "SippType": "uac",
                  "NeedAuth": true,
                  "Timeout": "20s"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "Name": "\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f 404 \u043e\u0442\u0432\u0435\u0442\u0430 \u043d\u0430 REGISTER c \u0437\u0430\u043f\u0440\u0435\u0448\u0451\u043d\u043d\u044b\u043c RURI",
      "Description": "\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c REGISTER \u0441 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u043b\u044c\u043d\u044b\u043c \u0434\u043e\u043c\u0435\u043d\u043e\u043c \u0432 RURI, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u043f\u043e\u043f\u0430\u0434\u0430\u0442\u044c \u0432 \u0441\u043f\u0438\u0441\u043e\u043a allowed_ruri. \u0414\u043e\u043b\u0436\u043d\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c 404 \u043e\u0442\u0432\u0435\u0442",
      "TestProcedure": [
        {
          "ManualReg": {
            "Users": {
              "11": {
                "script": "register_test/send_reg_with_foreign_ruri.xml",
                "additional_options": "-set FOREIGN_DOM domain1.faka"
              }
            }
          }
        }
      ]
    },
    {
      "Name": "\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f 403 \u043e\u0442\u0432\u0435\u0442\u0430 \u043d\u0430 REGISTER \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u044f \u0438\u0441\u043a\u043e\u043c\u043e\u0433\u043e \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430",
      "Description": "\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c REGISTER \u0434\u043b\u044f \u044e\u0437\u0435\u0440\u0430, \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u0434\u043e\u043c\u0435\u043d\u0435.",
      "TestProcedure": [
        {
          "ManualReg": {
            "Users": {
              "11": {
                "script": "register_test/failed_registration_with_auth.xml"
              }
            }
          }
        }
      ]
    },
    {
      "Name": "\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0443\u0434\u0430\u0447\u043d\u043e\u0439 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438, \u0435\u0441\u043b\u0438 \u0437\u0430\u043f\u0440\u043e\u0441 \u043f\u0440\u0438\u0445\u043e\u0434\u0438\u0442 \u0441 public_name",
      "Description": "\u0412 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u044e\u0437\u0435\u0440 100@pbx, \u043c\u044b \u0436\u0435 \u043f\u044b\u0442\u0430\u0435\u043c\u0441\u044f \u0437\u0430\u0440\u0435\u0433\u0430\u0442\u044c 100@public_name. \u0412 \u0441\u043b\u0443\u0447\u0430\u0435 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u044f \u043a\u043e\u043d\u0444\u043b\u0438\u043a\u0442\u043e\u0432 (\u0434\u0443\u0431\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u0432), \u044e\u0437\u0435\u0440 \u0434\u043e\u043b\u0436\u0435\u043d \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",
      "TestProcedure": [
        {
          "ManualReg": {
            "Users": {
              "12": {
                "script": "register_test/success_registration_with_auth.xml"
              }
            }
          }
        },
        {
          "StartUA": [
            {
              "Type": "User",
              "UserId": 8,
              "Name": "UAC1_TEST_CALL",
              "Commands": [
                {
                  "SourceFile": "simple_ua/uac_recv_bye.xml",
                  "Options": "-m 1 -set CDPN %%12.Number%% -set CDPNDOM %%8.SipDomain%%",
                  "SippType": "uac",
                  "NeedAuth": true,
                  "Timeout": "20s"
                }
              ]
            },
            {
              "Type": "User",
              "UserId": 12,
              "Name": "UAS2_TEST_CALL",
              "Commands": [
                {
                  "SourceFile": "simple_ua/uas_send_bye.xml",
                  "Options": "-m 1 -d 2000",
                  "SippType": "uas",
                  "NeedAuth": true,
                  "Timeout": "20s"
                }
              ]
            }
          ]
        },
        {
          "DropManualReg": {
            "Users": [
              "12"
            ]
          }
        }
      ]
    }
  ]
}